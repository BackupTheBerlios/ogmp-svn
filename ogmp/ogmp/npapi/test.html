<HTML>
  <HEAD>
    <TITLE>RealmTel Mozilla Phone Test</TITLE>

    <script type="text/javascript">
      <!--
         function get_ip_return(result)
         {
	    document.controlpanel.status.value=result;
	    alert(result);
         }

         function load_user_return(result, reason)
         {
	    document.controlpanel.status.value=result;
	    alert(result);
         }

         function regist_return(result, reason)
         {
	    document.controlpanel.status.value=result;
	    alert(result);
         }
      //-->
    </script>

  </HEAD>
  <BODY>
    <center>
      <h1> Scriptable VOIP Client </h1>
    </center>

    <p>
      This page contains a testcase which demonstrates the work of Mozilla scriptable VOIP Client. 
      This example plug-in has no native GUI and does not draw anything in the plugin window. 
      Clicking on the button will result in calling native plugin method from JavaScript. 
      The callback functions defined in this page header for handler the client event.
    </p>

    <p>Get_IP will instruct the plug-in to retrieve the VOIP user agent IP address and return it to JavaScript.</p>
    <p>Load_User will instruct the plugin to set the given user as current VOIP user.</p>
    <p>Register will instruct the plugin to register current user to the SIP Domain/Realm.</p>

    <p>How to show the result is up to web page designer, this give the VOIP client a scriptable user-interface.</p>
    <p> - Following is the javascript API of this plugin:</p>

   <pre>
     /******************************************
      * Some read-only attribute of the plugin *
      ******************************************/
     document.sipua.useragent;  // Get the name of the SIP useragent.
     document.sipua.lience;     // Get the lience of the plugin.
     document.sipua.version;    // Get the version of the plugin.
     
     /******************
      * Plugin Methods *
      ******************/
     // Load user with userid('bin1') with the length of userid
     document.sipua.load_user(userid, userid.length);

     // Register user with user fullname('Bin Zhang'), the length of fullname, home_sip_router('hubble.realmtel.net'),
     // user_sipid('bin1@realmtel.net'), expire_seconds(1800)
     document.sipua.regist(user_fullname, user_fullname.length, home_router, user_at_domain, expire_seconds);

     // Unregister home_sip_router('hubble.realmtel.net') user('bin1@realmtel.net')
     document.sipua.unregist(home_router, user_at_domain);

     // Create a call with title('Hello') and description('Discuss tech issue with you')
     document.sipua.new_call(title, description);

     // Call destination('bin8@realmtel.net')
     document.sipua.call(callee_at_dest_domain);

     // Answer call on lineno(2)
     document.sipua.answer(lineno);

     // Hangup call on lineno(3)
     document.sipua.bye(lineno);
     
     /*********************************************************
      * Callback functions used to handle Mozilla Phone event *
      *********************************************************/
     // your action when got ip 
     function get_ip_return(ip)
     {...}
     
     // your action when even load user ok or not
     // @param result - 'loaduser_ok' if succeed, 'loaduser_fail' if failure.
     // @param reason - the reason of the result.
     function load_user_return(result, reason)
     {...}
     
     // your action when even register ok or not
     // @param result - 'reg_ok' if succeed, 'reg_fail' if failure.
     // @param reason - the reason of the result.
     function register_return(result, reason)
     {...}
     
  </pre>
  <hr/>

  <!-- embed the plugin into this page //-->
  <embed name="sipua" type="application/x-vnd-realmtel-sipua" width=1 height=1 hidden="true" />

  <center>

    <script language="javascript">
      <!--
      if (!document.sipua)
      {
         document.write('<p>No VOIP Client Found</p>');
      }
      else
      {
	 //Get Plugin Attribute(UserAgent)
         document.write('<p>UserAgent: ', document.sipua.useragent, '</p>');

	 //Get Plugin Attribute(Licence)
	 document.write('<p>Licence: ', document.sipua.licence, '</p>');

	 //Get Plugin Attribute(Version)
	 document.write('<p>Version: ', document.sipua.version, '</p>');
      }
      //-->
    </script>

    <form name="controlpanel">
      <!-- Apply a text box as status bar //-->
      <input type="text" name="status" value="idle"/>

      <!--  
        When mouse click, call plugin's get_ip() method to retrieve IP address, the address send to function
        get_ip_return() in this page header. 
      //-->
      <input type="button" value="get ip" onclick='document.sipua.get_ip()'/>

      <!-- 
        When click the button['load_user'], call plugin's load_user() method to set current user, the result will
        be sent to function load_user_return() in this page header. 
      //-->
      <input type="button" value="load_user" onclick='document.sipua.load_user("hling", "hling".length)'/>

      <!-- 
        Click Button['register'] to call plugin's regist() method to register this user, result will be sent to
        function regist_return(), in this page header.  
      //-->
      <input type="button" value="register" onclick='document.sipua.regist("Heming Ling", "Heming Ling".length, "rosella.timedia.org", "heming@timedia.org", 1800)'/>
    </form>

  </center>

</BODY>
</HTML>
